(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{538:function(t,e,r){t.exports=r.p+"assets/img/599d0f25gy1ftyjq2ysbhj20df04rdfz.e562158c.jpg"},539:function(t,e,r){t.exports=r.p+"assets/img/599d0f25gy1ftykaa9l5qj20nz0dmt97.a6d9e0e7.jpg"},540:function(t,e,r){t.exports=r.p+"assets/img/599d0f25gy1ftykd06jyyj20km0c1mxj.d7261df5.jpg"},541:function(t,e,r){t.exports=r.p+"assets/img/599d0f25gy1ftyki1oc28j20pr040aa5.932aee44.jpg"},628:function(t,e,r){"use strict";r.r(e);var s=r(6),o=Object(s.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("踩坑日记与 Windows 服务器部署 Asp.net core 指南。")]),t._v(" "),s("h3",{attrs:{id:"准备"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#准备"}},[t._v("#")]),t._v(" 准备")]),t._v(" "),s("p",[t._v("操作系统：Windows Server 2008 R2 或更高版本\n文件：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.microsoft.com/en-us/download/details.aspx?id=52685",target:"_blank",rel:"noopener noreferrer"}},[t._v("Microsoft Visual C++ 2015 Redistributable"),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("aspnetcore-runtime")]),t._v(" "),s("li",[t._v("dotnet-hosting")])]),t._v(" "),s("p",[t._v("后面这两个文件的下载地址："),s("a",{attrs:{href:"https://www.microsoft.com/net/download/archives",target:"_blank",rel:"noopener noreferrer"}},[t._v(".NET download archives for Linux, macOS, and Windows"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("img",{attrs:{src:r(538),alt:""}})]),t._v(" "),s("h3",{attrs:{id:"准备-asp-net-core-web-应用程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#准备-asp-net-core-web-应用程序"}},[t._v("#")]),t._v(" 准备 asp.net core web 应用程序")]),t._v(" "),s("p",[t._v("Step1 使用 VS2017 建立 asp.net core web 应用程序。")]),t._v(" "),s("p",[t._v("Step2 发布。使用 “IIS，FTP” - “文件系统” 的发布方式，获取发布文件。")]),t._v(" "),s("p",[t._v("具体的操作，可参考这里："),s("br"),t._v(" "),s("a",{attrs:{href:"http://www.cnblogs.com/sundar/p/9195550.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 IIS 在 Windows 上托管 ASP.NET Core2.0 - Sundar - 博客园"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("Step3 IIS配置。在服务器上启用 IIS 服务，默认配置即可。")]),t._v(" "),s("h3",{attrs:{id:"安装-asp-net-core-运行环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-asp-net-core-运行环境"}},[t._v("#")]),t._v(" 安装 asp.net core 运行环境")]),t._v(" "),s("p",[t._v("在服务器上分别安装")]),t._v(" "),s("ol",[s("li",[t._v("Microsoft Visual C++ 2015 Redistributable")]),t._v(" "),s("li",[t._v("aspnetcore-runtime")]),t._v(" "),s("li",[t._v("dotnet-hosting")])]),t._v(" "),s("p",[t._v("安装完成后，重启系统，或从命令提示符处依次执行 "),s("code",[t._v("net stop was /y")]),t._v(" 和 "),s("code",[t._v("net start w3svc")]),t._v(" 。\n重新启动 IIS 将选取安装程序对系统 PATH 所作的更改。")]),t._v(" "),s("blockquote",[s("p",[t._v("安装 asp.net core 运行环境必须在配置好 IIS 之后进行。")])]),t._v(" "),s("h3",{attrs:{id:"在-iis-中添加网站"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在-iis-中添加网站"}},[t._v("#")]),t._v(" 在 IIS 中添加网站")]),t._v(" "),s("p",[t._v("无特殊配置，需要注意的是，将应用程序池中对应的项修改为 "),s("strong",[t._v("无托管代码")]),t._v(" 。")]),t._v(" "),s("blockquote",[s("p",[t._v("以上所有操作都可以参考 "),s("a",{attrs:{href:"http://www.cnblogs.com/sundar/p/9195550.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 IIS 在 Windows 上托管 ASP.NET Core2.0 - Sundar - 博客园"),s("OutboundLink")],1),t._v(" 这篇博文，写得很清晰。")])]),t._v(" "),s("h3",{attrs:{id:"重点-可能会遇到的问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#重点-可能会遇到的问题"}},[t._v("#")]),t._v(" 重点：可能会遇到的问题")]),t._v(" "),s("h4",{attrs:{id:"_500-19"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_500-19"}},[t._v("#")]),t._v(" 500.19")]),t._v(" "),s("p",[s("img",{attrs:{src:r(539),alt:""}})]),t._v(" "),s("p",[t._v("原因：安装 dotnet-hosting 在添加 IIS 之前，或者安装完成之后，没有进行重启。")]),t._v(" "),s("p",[t._v("解决方案：重新安装 dotnet-hosting ，选择修复选项。然后重启服务器。")]),t._v(" "),s("h4",{attrs:{id:"_502-5"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_502-5"}},[t._v("#")]),t._v(" 502.5")]),t._v(" "),s("p",[s("img",{attrs:{src:r(540),alt:""}})]),t._v(" "),s("p",[t._v("原因：asp.net 所需运行环境不够。\n解决：\n方案1： 安装 SDK 。 但这种方案没有在我这里生效，安装姿势不对？\n方案2： 在 asp.net 项目的 csproj 文件中添加"),s("br"),t._v(" "),s("code",[t._v("<PublishWithAspNetCoreTargetManifest>false</PublishWithAspNetCoreTargetManifest>")])]),t._v(" "),s("p",[s("img",{attrs:{src:r(541),alt:""}})]),t._v(" "),s("p",[t._v("然后重新发布，会发现发布文件里面多了很多依赖项，更新服务器端的文件，重启网站，应该就可以大功告成了。")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("简单的事情，一定有简单的解决方案，对于部署 asp.net core 这种应该很标准化的操作，如果遇到问题需要很复杂，看起来就很奇奇怪怪的方案，那很可能是方向错了。")]),t._v(" "),s("p",[t._v("之前就踩过坑，尝试采用安装重定向等等奇怪的方法。")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("参考资料：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"http://www.cnblogs.com/sundar/p/9195550.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 IIS 在 Windows 上托管 ASP.NET Core2.0 - Sundar - 博客园"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://stackoverflow.com/questions/45114166/asp-net-core-2-0-preview-2-on-iis-error-502-5",target:"_blank",rel:"noopener noreferrer"}},[t._v("ASP.NET Core 2.0 Preview 2 on IIS error 502.5 - Stack Overflow"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/iis/?view=aspnetcore-2.1&tabs=aspnetcore2x",target:"_blank",rel:"noopener noreferrer"}},[t._v("Host ASP.NET Core on Windows with IIS | Microsoft Docs"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/aspnet/core/host-and-deploy/iis/index?view=aspnetcore-2.1&tabs=aspnetcore2x",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 IIS 在 Windows 上托管 ASP.NET Core | Microsoft Docs"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=o.exports}}]);